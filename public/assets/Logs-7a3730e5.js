import{d as q,a as l,c as L,e as o,o as C,g as e,f as a,t as f,m as d,_ as N,r as w,u as ee,s as oe,h as le,k as te,j as B,i as s,F,b as j,l as ne,C as D}from"./app-4f42dbc1.js";import{H as T,P as ae}from"./HeaderCell-2834f7a9.js";const se={class:"mb-3"},de=d("strong",null,"Сообщение",-1),ue={class:"mb-3"},ce=d("strong",null,"Тип лога",-1),re={class:"mb-3"},ie=d("strong",null,"Дата создания",-1),_e=q({__name:"LogModal",props:{log:{required:!0},isVisible:{type:Boolean,required:!0},closeModal:{type:Function,required:!0}},setup(i){return(p,u)=>{const g=l("CModalTitle"),b=l("CModalHeader"),c=l("CFormLabel"),r=l("CCol"),y=l("CForm"),V=l("CModalBody"),A=l("CButton"),h=l("CModalFooter"),k=l("CModal");return C(),L(k,{alignment:"center",visible:i.isVisible&&i.log!==null,onClose:u[1]||(u[1]=_=>i.closeModal())},{default:o(()=>[e(b,null,{default:o(()=>[e(g,null,{default:o(()=>[a("Лог № "+f(i.log.id),1)]),_:1})]),_:1}),e(V,null,{default:o(()=>[e(y,{class:"w-100"},{default:o(()=>[d("div",se,[e(c,{for:"message"},{default:o(()=>[de]),_:1}),e(r,null,{default:o(()=>[a(f(i.log.message),1)]),_:1})]),d("div",ue,[e(c,{for:"floatingSelect"},{default:o(()=>[ce]),_:1}),e(r,null,{default:o(()=>[a(f(i.log.type),1)]),_:1})]),d("div",re,[e(c,{for:"requiredStartAt"},{default:o(()=>[ie]),_:1}),e(r,null,{default:o(()=>[a(f(i.log.createdAt),1)]),_:1})])]),_:1})]),_:1}),e(h,null,{default:o(()=>[e(A,{color:"secondary",class:"text-white",onClick:u[0]||(u[0]=_=>i.closeModal())},{default:o(()=>[a(" Закрыть ")]),_:1})]),_:1})]),_:1},8,["visible"])}}}),me=N(_e,[["__file","C:/OSPanel/domains/tgMailer/resources/js/modals/LogModal.vue"]]),fe=d("option",{value:""},"Открыть меню выбора",-1),Ce=d("option",{value:"success"},"Success",-1),pe=d("option",{value:"warning"},"Warning",-1),ge=d("option",{value:"info"},"Info",-1),ye=d("option",{value:"error"},"Error",-1),ve=d("strong",null,"Удалить все логи, дата создания которых ранее, чем ",-1),be=q({__name:"Logs",setup(i){const p=w(!1),u=ee(),{data:g,isLoading:b,searchParams:c}=oe(u),r=w(null),y=w(null);le(()=>{u.getData()}),te(()=>{u.setDefaultStore()});const V=_=>{y.value=_,p.value=!0},A=()=>{y.value=null,p.value=!p.value},h=_=>{D.actionModal().then(n=>{n.isConfirmed&&u.destroy("logs/"+_)})},k=()=>{r.value===null?D.swalMessage("error","Для массового удаления необходимо заполнить дату"):D.actionModal("warning","Вы действительно хотите удалить все логи, дата создания которых ранее, чем "+r.value+"?","Отменить действие будет невозможно.").then(_=>{_.isConfirmed&&u.multipleDestroy("logs/multiple/destroy",{dateToDelete:r.value}).then(()=>{r.value=null})})};return(_,n)=>{const R=l("CAccordionHeader"),U=l("CFormInput"),m=l("CCol"),H=l("CFormLabel"),$=l("VueDatePicker"),z=l("CFormSelect"),x=l("CIcon"),v=l("CButton"),I=l("CRow"),E=l("CAccordionBody"),O=l("CAccordionItem"),W=l("CAccordion"),G=l("CForm"),S=l("CTableHeaderCell"),P=l("CTableRow"),J=l("CTableHead"),M=l("CTableDataCell"),K=l("CBadge"),Q=l("CTableBody"),X=l("CTable"),Y=l("CAlert");return C(),B(F,null,[e(W,{flush:"","active-item-key":1,"always-open":"",class:"mb-3"},{default:o(()=>[e(O,{"item-key":1},{default:o(()=>[e(R,null,{default:o(()=>[a(" Поиск... ")]),_:1}),e(E,null,{default:o(()=>[e(I,{class:"gap-2"},{default:o(()=>[e(m,{xl:"12",xxl:"12"},{default:o(()=>[e(U,{id:"mailingId","floating-label":"Номер рассылки",placeholder:"Номер рассылки",modelValue:s(c).mailingId,"onUpdate:modelValue":n[0]||(n[0]=t=>s(c).mailingId=t),type:"number"},null,8,["modelValue"])]),_:1}),e(m,{xl:"12",xxl:"12"},{default:o(()=>[e(H,{for:"createdAt"},{default:o(()=>[a("Дата создания")]),_:1}),e($,{range:"","multi-calendars":"",id:"createdAt","model-type":"yyyy-MM-dd HH:mm:ss",modelValue:s(c).createdAt,"onUpdate:modelValue":n[1]||(n[1]=t=>s(c).createdAt=t)},null,8,["modelValue"])]),_:1}),e(m,{xl:"12",xxl:"12"},{default:o(()=>[e(z,{id:"type",floatingLabel:"Тип лога","aria-label":"Тип лога",modelValue:s(c).type,"onUpdate:modelValue":n[2]||(n[2]=t=>s(c).type=t)},{default:o(()=>[fe,Ce,pe,ge,ye]),_:1},8,["modelValue"])]),_:1}),e(m,{class:"d-flex justify-content-between"},{default:o(()=>[e(v,{color:"danger",variant:"ghost",class:"d-flex border-0",onClick:n[3]||(n[3]=t=>c.value={})},{default:o(()=>[e(x,{icon:"cilClearAll",size:"xl",class:"me-1"}),a(" Очистить все поля ")]),_:1}),e(v,{color:"info",variant:"ghost",class:"d-flex border-0",onClick:n[4]||(n[4]=t=>s(u).getData())},{default:o(()=>[e(x,{icon:"cilSearch",size:"xl",class:"me-1"}),a(" Поиск ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),!s(b)&&s(g).length>0?(C(),B(F,{key:0},[e(G,{class:"d-flex justify-content-end mb-3"},{default:o(()=>[e(m,{xl:"auto",xxl:"auto",lg:"auto",md:"auto",sm:"auto",class:"p-0"},{default:o(()=>[e(H,{for:"dateToDelete"},{default:o(()=>[ve]),_:1}),e(I,{class:"gap-2 m-0"},{default:o(()=>[e(m,{xl:"",xxl:"",lg:"",md:"",sm:"",class:"p-0"},{default:o(()=>[e($,{modelValue:r.value,"onUpdate:modelValue":n[5]||(n[5]=t=>r.value=t),id:"dateToDelete","max-date":new Date,"model-type":"yyyy-MM-dd HH:mm:ss",required:""},null,8,["modelValue","max-date"])]),_:1}),e(m,{xl:"auto",xxl:"auto",lg:"auto",md:"auto",sm:"auto",class:"d-flex p-0"},{default:o(()=>[e(v,{class:"w-100",color:"primary",onClick:n[6]||(n[6]=t=>k())},{default:o(()=>[a("Удалить")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(X,{bordered:"",hover:"",responsive:""},{default:o(()=>[e(J,null,{default:o(()=>[e(P,null,{default:o(()=>[e(T,{property:"id",name:"ID"}),e(T,{property:"message",name:"Сообщение"}),e(T,{property:"type",name:"Тип лога"}),e(T,{property:"createdAt",name:"Дата создания"}),e(S,{scope:"col"},{default:o(()=>[a("Действия")]),_:1})]),_:1})]),_:1}),e(Q,null,{default:o(()=>[(C(!0),B(F,null,ne(s(g),t=>(C(),L(P,null,{default:o(()=>[e(S,{scope:"row"},{default:o(()=>[a(f(t.id),1)]),_:2},1024),e(M,null,{default:o(()=>[a(f(t.message),1)]),_:2},1024),e(M,null,{default:o(()=>[e(K,{color:t.type==="error"?"danger":t.type,shape:"rounded-pill"},{default:o(()=>[a(f(t.type),1)]),_:2},1032,["color"])]),_:2},1024),e(M,null,{default:o(()=>[a(f(t.createdAt===null?"-":t.createdAt),1)]),_:2},1024),e(M,null,{default:o(()=>[e(m,{class:"d-flex gap-2"},{default:o(()=>[e(v,{color:"info",class:"text-white",shape:"rounded-pill",onClick:Z=>V(t)},{default:o(()=>[e(x,{icon:"cilInfo"})]),_:2},1032,["onClick"]),e(v,{color:"danger",class:"text-white",shape:"rounded-pill",onClick:Z=>h(t.id)},{default:o(()=>[e(x,{icon:"cilTrash"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1}),e(ae)],64)):j("v-if",!0),!s(b)&&s(g).length<=0?(C(),L(Y,{key:1,color:"info"},{default:o(()=>[a("По данному запросу данных не найдено")]),_:1})):j("v-if",!0),e(me,{"close-modal":A,log:y.value,"is-visible":p.value},null,8,["log","is-visible"])],64)}}}),Te=N(be,[["__file","C:/OSPanel/domains/tgMailer/resources/js/pages/Logs.vue"]]);export{Te as default};
